(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var metals = require("./metals");
var metalDataSet = new metals.MetalDataSet();
function createMetalNumberInput(prefix, metal, metalPropertyName, additionalOnChange) {
    var div = document.createElement("div");
    var input = document.createElement("input");
    var msgP = document.createElement("p");
    msgP.classList.add("error-msg");
    input.value = metal.getProperty(metalPropertyName).toString();
    input.classList.add(prefix);
    input.id = prefix + "_" + metal.idSuffix;
    input.type = "number";
    input.addEventListener("change", function (event) {
        var _a;
        var val = event.target.value;
        try {
            msgP.textContent = "";
            var floatVal = parseFloat(val);
            var m = metalDataSet.metals[metal.idSuffix];
            Object.assign(m, (_a = {}, _a[metalPropertyName] = floatVal, _a));
            if (additionalOnChange)
                additionalOnChange(metal.idSuffix);
            calculate();
        }
        catch (e) {
            var msg = void 0;
            if (e instanceof RangeError) {
                msg = e.message;
            }
            else {
                msg = "Invalid value " + input.value;
            }
            msgP.textContent = msg;
            clearCalculation();
        }
    });
    div.append(input);
    div.append(msgP);
    return div;
}
function appendMetalTableRow(metal, table) {
    var row = table
        .getElementsByTagName("tbody")[0]
        .insertRow();
    var toggleButton = document.createElement("input");
    var label = document.createElement("label");
    toggleButton.type = "checkbox";
    toggleButton.classList.add("toggle");
    toggleButton.id = "toggle_" + metal.idSuffix;
    label.htmlFor = "toggle_" + metal.idSuffix;
    var metalCell = document.createElement("th");
    toggleButton.addEventListener("change", function () {
        toggleMetal(this.checked, metal);
    });
    metalCell.appendChild(toggleButton);
    metalCell.appendChild(label);
    var metalID = document.createElement("span");
    metalID.innerHTML = metal.symbol;
    metalID.classList.add("metal-symbol");
    metalCell.appendChild(metalID);
    row.appendChild(metalCell);
    var affinityCell = row.insertCell(-1);
    affinityCell.classList.add("affinity", "grouped");
    var affinityInput = createMetalNumberInput("affinity", metal, "affinity", function (id) {
        var m = metalDataSet.metals[id];
        (document.getElementById("metalation_delta_g_" + id)).innerText = m.metalationDeltaG.toFixed(1).toString();
    });
    affinityCell.appendChild(affinityInput);
    var mDeltaGCell = row.insertCell(-1);
    mDeltaGCell.classList.add("grouped", "right-spacing");
    mDeltaGCell.id = "metalation_delta_g_" + metal.idSuffix;
    mDeltaGCell.innerText = metal.metalationDeltaG.toFixed(1).toString();
    var bmcCell = row.insertCell(-1);
    bmcCell.classList.add("bmc", "grouped");
    var bmcInput = createMetalNumberInput("bmc", metal, "bufferedMetalConcentration", function (id) {
        var m = metalDataSet.metals[id];
        (document.getElementById("ia_delta_g_" + id)).innerText = m.intracellularAvailableDeltaG.toFixed(1).toString();
    });
    bmcCell.appendChild(bmcInput);
    var iaDeltaGCell = row.insertCell(-1);
    iaDeltaGCell.classList.add("grouped");
    iaDeltaGCell.id = "ia_delta_g_" + metal.idSuffix;
    iaDeltaGCell.innerText = metal.intracellularAvailableDeltaG
        .toFixed(1)
        .toString();
    var resultCell = row.insertCell(-1);
    resultCell.classList.add("result");
    resultCell.id = "result_" + metal.idSuffix;
}
function toggleMetal(willTurnOff, metal) {
    document.getElementById("affinity_" + metal.idSuffix).disabled = willTurnOff;
    document.getElementById("bmc_" + metal.idSuffix).disabled = willTurnOff;
    if (willTurnOff) {
        metal.switchOffMetal();
    }
    else {
        metal.resetValues();
    }
    updateRow(metal);
    calculate();
}
function updateRow(metal) {
    var id = metal.idSuffix;
    document.getElementById("affinity_" + id).value =
        metal.affinity.toString();
    document.getElementById("metalation_delta_g_" + id).innerText =
        metal.metalationDeltaG.toFixed(1).toString();
    document.getElementById("bmc_" + id).value =
        metal.bufferedMetalConcentration.toString();
    document.getElementById("ia_delta_g_" + id).innerText =
        metal.intracellularAvailableDeltaG.toFixed(1).toString();
}
function calculate() {
    var results = metalDataSet.calculateOccupancy();
    for (var id in metalDataSet.metals) {
        var r = results[id];
        var resultCell = (document.getElementById("result_" + id));
        resultCell.innerHTML = (r * 100).toFixed(2).toString() + "%";
    }
    var totalCell = (document.getElementById("total-metalation"));
    totalCell.innerHTML = (results["total"] * 100).toFixed(2).toString() + "%";
    document.getElementById("download-btn").disabled = false;
}
function clearCalculation() {
    Array.from(document.getElementsByClassName("result")).forEach(function (cell) {
        cell.innerHTML = "N/A";
    });
    document.getElementById("download-btn").disabled = true;
}
function reset() {
    for (var id in metalDataSet.metals) {
        var m = metalDataSet.metals[id];
        m.resetValues();
        updateRow(m);
    }
    calculate();
}
// Quick and simple export target #tableId into a csv
function downloadTableAsCsv(tableId, separator) {
    if (separator === void 0) { separator = ","; }
    // Select rows from tableId
    var rows = document.querySelectorAll("table#" + tableId + " tr");
    // Construct csv
    var csv = [];
    for (var i = 0; i < rows.length; i++) {
        var row = [];
        var cols = (rows[i].querySelectorAll("td, th"));
        for (var j = 0; j < cols.length; j++) {
            // Clean innertext to remove multiple spaces and jumpline (break csv)
            var data = void 0;
            var inputs = cols[j].getElementsByTagName("input");
            if (inputs.length > 0) {
                data = inputs[0].value;
            }
            else {
                data = cols[j].innerText;
            }
            // Remove line breaks and escape double-quote with double-double-quote
            data = data.replace(/(\r\n|\n|\r)/gm, "").replace(/(\s\s)/gm, " ");
            data = data.replace(/"/g, '""');
            data = data.replace(/\u2206/g, "Delta ");
            // Push escaped string
            row.push('"' + data + '"');
        }
        csv.push(row.join(separator));
    }
    var csvString = csv.join("\n");
    // Download it
    var filename = "export_" + tableId + "_" + new Date().toLocaleDateString() + ".csv";
    var link = document.createElement("a");
    link.style.display = "none";
    link.setAttribute("target", "_blank");
    link.setAttribute("href", "data:text/csv;charset=utf-8," + encodeURIComponent(csvString));
    link.setAttribute("download", filename);
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}
window.addEventListener("DOMContentLoaded", function () {
    var metalTable = (document.getElementById("metalation-table"));
    for (var id in metalDataSet.metals) {
        var m = metalDataSet.metals[id];
        appendMetalTableRow(m, metalTable);
    }
    document.getElementById("download-btn").onclick = function () {
        downloadTableAsCsv("metalation-table");
    };
    document.getElementById("reset-btn").onclick = function () {
        reset();
    };
    calculate();
});

},{"./metals":2}],2:[function(require,module,exports){
"use strict";
var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {
    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
        if (ar || !(i in from)) {
            if (!ar) ar = Array.prototype.slice.call(from, 0, i);
            ar[i] = from[i];
        }
    }
    return to.concat(ar || Array.prototype.slice.call(from));
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.MetalDataSet = exports.Metal = void 0;
/**
 * An object to store values for a single metal and calculate delta G values
 */
var Metal = /** @class */ (function () {
    function Metal(name, symbol, affinity, concentration) {
        this.name = name;
        this.symbol = symbol;
        this.affinity = affinity;
        this.bufferedMetalConcentration = concentration;
        this.idSuffix = symbol.toLowerCase();
        this._defaultAffinity = affinity;
        this._defaultMetalConcentration = concentration;
    }
    Metal.prototype.calculateDeltaG = function (moleValue) {
        return (8.314 * 298.15 * Math.log(moleValue)) / 1000;
    };
    Metal.prototype.checkRange = function (val, fieldName) {
        if (isNaN(val))
            throw new RangeError(fieldName + " must be set");
        if (val < 1e-30 || val > 1000) {
            throw new RangeError(fieldName + " must be between 1e-30 and 1000");
        }
    };
    Object.defineProperty(Metal.prototype, "affinity", {
        get: function () {
            return this._affinity;
        },
        set: function (val) {
            this.checkRange(val, "Affinity");
            this._affinity = val;
            this._metalationDeltaG = this.calculateDeltaG(this._affinity);
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Metal.prototype, "metalationDeltaG", {
        get: function () {
            return this._metalationDeltaG;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Metal.prototype, "bufferedMetalConcentration", {
        get: function () {
            return this._bufferedMetalConcentration;
        },
        set: function (val) {
            this.checkRange(val, "Buffered metal concentration");
            this._bufferedMetalConcentration = val;
            this._intracellularAvailableDeltaG = this.calculateDeltaG(this._bufferedMetalConcentration);
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Metal.prototype, "intracellularAvailableDeltaG", {
        get: function () {
            return this._intracellularAvailableDeltaG;
        },
        set: function (val) {
            if (val <= 0)
                throw new RangeError("Intracellular available âˆ†G must be > 0");
            this._intracellularAvailableDeltaG = val;
        },
        enumerable: false,
        configurable: true
    });
    Metal.prototype.getProperty = function (key) {
        return this[key];
    };
    Metal.prototype.switchOffMetal = function () {
        this.affinity = 1000;
        this.bufferedMetalConcentration = this._defaultMetalConcentration;
    };
    Metal.prototype.resetValues = function () {
        this.affinity = this._defaultAffinity;
        this.bufferedMetalConcentration = this._defaultMetalConcentration;
    };
    return Metal;
}());
exports.Metal = Metal;
var METAL_VALS = [
    ["Magnesium", "Mg", 1e3, 2.7e-3],
    ["Manganese", "Mn", 1e3, 2.6e-6],
    ["Iron", "Fe", 1e-6, 4.8e-8],
    ["Cobalt", "Co", 3e-11, 2.5e-9],
    ["Nickel", "Ni", 9.8e-10, 1.8e-13],
    ["Copper", "Cu", 2.4e-16, 1.2e-18],
    ["Zinc", "Zn", 1.9e-13, 1.19e-12],
];
var MetalDataSet = /** @class */ (function () {
    function MetalDataSet() {
        this.metals = {};
        for (var _i = 0, METAL_VALS_1 = METAL_VALS; _i < METAL_VALS_1.length; _i++) {
            var m = METAL_VALS_1[_i];
            this.metals[m[1].toLowerCase()] = new (Metal.bind.apply(Metal, __spreadArray([void 0], m, false)))();
        }
    }
    MetalDataSet.prototype.calculateOccupancy = function () {
        var expScaledDifferences = {};
        var totalDiffs = 0;
        for (var id in this.metals) {
            var m = this.metals[id];
            expScaledDifferences[id] = Math.exp((1000 * (m.intracellularAvailableDeltaG - m.metalationDeltaG)) /
                (8.314 * 298.15));
            totalDiffs += expScaledDifferences[id];
        }
        var occupancies = {};
        var totalOccupancy = 0;
        for (var id in this.metals) {
            occupancies[id] = expScaledDifferences[id] / (1 + totalDiffs);
            totalOccupancy += occupancies[id];
        }
        occupancies["total"] = totalOccupancy;
        return occupancies;
    };
    return MetalDataSet;
}());
exports.MetalDataSet = MetalDataSet;

},{}]},{},[1,2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvbWFpbi50cyIsInNyYy9tZXRhbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLGlDQUFtQztBQUVuQyxJQUFNLFlBQVksR0FBRyxJQUFJLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQztBQUUvQyxTQUFTLHNCQUFzQixDQUM3QixNQUFjLEVBQ2QsS0FBbUIsRUFDbkIsaUJBQXFDLEVBQ3JDLGtCQUF3QztJQUV4QyxJQUFNLEdBQUcsR0FBbUIsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUMxRCxJQUFNLEtBQUssR0FBcUIsUUFBUSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNoRSxJQUFNLElBQUksR0FBeUIsUUFBUSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUMvRCxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUNoQyxLQUFLLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUM5RCxLQUFLLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUM1QixLQUFLLENBQUMsRUFBRSxHQUFHLE1BQU0sR0FBRyxHQUFHLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQztJQUN6QyxLQUFLLENBQUMsSUFBSSxHQUFHLFFBQVEsQ0FBQztJQUN0QixLQUFLLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxFQUFFLFVBQVUsS0FBSzs7UUFDOUMsSUFBTSxHQUFHLEdBQXNCLEtBQUssQ0FBQyxNQUFPLENBQUMsS0FBSyxDQUFDO1FBQ25ELElBQUk7WUFDRixJQUFJLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQztZQUN0QixJQUFNLFFBQVEsR0FBRyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7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LElBQUksSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUM1QixJQUFNLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQzFCLG9CQUFvQixDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQ2pDLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQyxDQUFDLDRCQUE0QixHQUFHLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO2dCQUM1RCxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUMsQ0FDbkIsQ0FBQztZQUNGLFVBQVUsSUFBSSxvQkFBb0IsQ0FBQyxFQUFFLENBQUMsQ0FBQztTQUN4QztRQUVELElBQU0sV0FBVyxHQUE2QixFQUFFLENBQUM7UUFDakQsSUFBSSxjQUFjLEdBQUcsQ0FBQyxDQUFDO1FBRXZCLEtBQUssSUFBTSxFQUFFLElBQUksSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUM1QixXQUFXLENBQUMsRUFBRSxDQUFDLEdBQUcsb0JBQW9CLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBVSxDQUFDLENBQUM7WUFDOUQsY0FBYyxJQUFJLFdBQVcsQ0FBQyxFQUFFLENBQUMsQ0FBQztTQUNuQztRQUNELFdBQVcsQ0FBQyxPQUFPLENBQUMsR0FBRyxjQUFjLENBQUM7UUFFdEMsT0FBTyxXQUFXLENBQUM7SUFDckIsQ0FBQztJQUNILG1CQUFDO0FBQUQsQ0FqQ0EsQUFpQ0MsSUFBQTtBQWpDWSxvQ0FBWSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImltcG9ydCAqIGFzIG1ldGFscyBmcm9tIFwiLi9tZXRhbHNcIjtcblxuY29uc3QgbWV0YWxEYXRhU2V0ID0gbmV3IG1ldGFscy5NZXRhbERhdGFTZXQoKTtcblxuZnVuY3Rpb24gY3JlYXRlTWV0YWxOdW1iZXJJbnB1dChcbiAgcHJlZml4OiBzdHJpbmcsXG4gIG1ldGFsOiBtZXRhbHMuTWV0YWwsXG4gIG1ldGFsUHJvcGVydHlOYW1lOiBrZXlvZiBtZXRhbHMuTWV0YWwsXG4gIGFkZGl0aW9uYWxPbkNoYW5nZTogKGlkOiBzdHJpbmcpID0+IHZvaWRcbikge1xuICBjb25zdCBkaXYgPSA8SFRNTERpdkVsZW1lbnQ+ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgY29uc3QgaW5wdXQgPSA8SFRNTElucHV0RWxlbWVudD5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG4gIGNvbnN0IG1zZ1AgPSA8SFRNTFBhcmFncmFwaEVsZW1lbnQ+ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG4gIG1zZ1AuY2xhc3NMaXN0LmFkZChcImVycm9yLW1zZ1wiKTtcbiAgaW5wdXQudmFsdWUgPSBtZXRhbC5nZXRQcm9wZXJ0eShtZXRhbFByb3BlcnR5TmFtZSkudG9TdHJpbmcoKTtcbiAgaW5wdXQuY2xhc3NMaXN0LmFkZChwcmVmaXgpO1xuICBpbnB1dC5pZCA9IHByZWZpeCArIFwiX1wiICsgbWV0YWwuaWRTdWZmaXg7XG4gIGlucHV0LnR5cGUgPSBcIm51bWJlclwiO1xuICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGZ1bmN0aW9uIChldmVudCkge1xuICAgIGNvbnN0IHZhbCA9ICg8SFRNTElucHV0RWxlbWVudD5ldmVudC50YXJnZXQpLnZhbHVlO1xuICAgIHRyeSB7XG4gICAgICBtc2dQLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgIGNvbnN0IGZsb2F0VmFsID0gcGFyc2VGbG9hdCh2YWwpO1xuICAgICAgY29uc3QgbSA9IG1ldGFsRGF0YVNldC5tZXRhbHNbbWV0YWwuaWRTdWZmaXhdO1xuICAgICAgT2JqZWN0LmFzc2lnbihtLCB7IFttZXRhbFByb3BlcnR5TmFtZV06IGZsb2F0VmFsIH0pO1xuICAgICAgaWYgKGFkZGl0aW9uYWxPbkNoYW5nZSkgYWRkaXRpb25hbE9uQ2hhbmdlKG1ldGFsLmlkU3VmZml4KTtcbiAgICAgIGNhbGN1bGF0ZSgpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxldCBtc2c7XG4gICAgICBpZiAoZSBpbnN0YW5jZW9mIFJhbmdlRXJyb3IpIHtcbiAgICAgICAgbXNnID0gZS5tZXNzYWdlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbXNnID0gXCJJbnZhbGlkIHZhbHVlIFwiICsgaW5wdXQudmFsdWU7XG4gICAgICB9XG4gICAgICBtc2dQLnRleHRDb250ZW50ID0gbXNnO1xuICAgICAgY2xlYXJDYWxjdWxhdGlvbigpO1xuICAgIH1cbiAgfSk7XG4gIGRpdi5hcHBlbmQoaW5wdXQpO1xuICBkaXYuYXBwZW5kKG1zZ1ApO1xuICByZXR1cm4gZGl2O1xufVxuZnVuY3Rpb24gYXBwZW5kTWV0YWxUYWJsZVJvdyhtZXRhbDogbWV0YWxzLk1ldGFsLCB0YWJsZTogSFRNTFRhYmxlRWxlbWVudCkge1xuICBjb25zdCByb3c6IEhUTUxUYWJsZVJvd0VsZW1lbnQgPSB0YWJsZVxuICAgIC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRib2R5XCIpWzBdXG4gICAgLmluc2VydFJvdygpO1xuXG4gIGNvbnN0IHRvZ2dsZUJ1dHRvbiA9IDxIVE1MSW5wdXRFbGVtZW50PmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgY29uc3QgbGFiZWwgPSA8SFRNTExhYmVsRWxlbWVudD5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XG4gIHRvZ2dsZUJ1dHRvbi50eXBlID0gXCJjaGVja2JveFwiO1xuICB0b2dnbGVCdXR0b24uY2xhc3NMaXN0LmFkZChcInRvZ2dsZVwiKTtcbiAgdG9nZ2xlQnV0dG9uLmlkID0gXCJ0b2dnbGVfXCIgKyBtZXRhbC5pZFN1ZmZpeDtcbiAgbGFiZWwuaHRtbEZvciA9IFwidG9nZ2xlX1wiICsgbWV0YWwuaWRTdWZmaXg7XG4gIGNvbnN0IG1ldGFsQ2VsbCA9IDxIVE1MVGFibGVDZWxsRWxlbWVudD5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGhcIik7XG5cbiAgdG9nZ2xlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKCkge1xuICAgIHRvZ2dsZU1ldGFsKHRoaXMuY2hlY2tlZCwgbWV0YWwpO1xuICB9KTtcblxuICBtZXRhbENlbGwuYXBwZW5kQ2hpbGQodG9nZ2xlQnV0dG9uKTtcbiAgbWV0YWxDZWxsLmFwcGVuZENoaWxkKGxhYmVsKTtcbiAgY29uc3QgbWV0YWxJRCA9IDxIVE1MU3BhbkVsZW1lbnQ+ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gIG1ldGFsSUQuaW5uZXJIVE1MID0gbWV0YWwuc3ltYm9sO1xuICBtZXRhbElELmNsYXNzTGlzdC5hZGQoXCJtZXRhbC1zeW1ib2xcIik7XG4gIG1ldGFsQ2VsbC5hcHBlbmRDaGlsZChtZXRhbElEKTtcbiAgcm93LmFwcGVuZENoaWxkKG1ldGFsQ2VsbCk7XG5cbiAgY29uc3QgYWZmaW5pdHlDZWxsOiBIVE1MVGFibGVDZWxsRWxlbWVudCA9IHJvdy5pbnNlcnRDZWxsKC0xKTtcbiAgYWZmaW5pdHlDZWxsLmNsYXNzTGlzdC5hZGQoXCJhZmZpbml0eVwiLCBcImdyb3VwZWRcIik7XG4gIGNvbnN0IGFmZmluaXR5SW5wdXQgPSBjcmVhdGVNZXRhbE51bWJlcklucHV0KFxuICAgIFwiYWZmaW5pdHlcIixcbiAgICBtZXRhbCxcbiAgICBcImFmZmluaXR5XCIsXG4gICAgZnVuY3Rpb24gKGlkKSB7XG4gICAgICBjb25zdCBtID0gbWV0YWxEYXRhU2V0Lm1ldGFsc1tpZF07XG4gICAgICAoPEhUTUxUYWJsZUNlbGxFbGVtZW50PihcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtZXRhbGF0aW9uX2RlbHRhX2dfXCIgKyBpZClcbiAgICAgICkpLmlubmVyVGV4dCA9IG0ubWV0YWxhdGlvbkRlbHRhRy50b0ZpeGVkKDEpLnRvU3RyaW5nKCk7XG4gICAgfVxuICApO1xuICBhZmZpbml0eUNlbGwuYXBwZW5kQ2hpbGQoYWZmaW5pdHlJbnB1dCk7XG5cbiAgY29uc3QgbURlbHRhR0NlbGw6IEhUTUxUYWJsZUNlbGxFbGVtZW50ID0gcm93Lmluc2VydENlbGwoLTEpO1xuICBtRGVsdGFHQ2VsbC5jbGFzc0xpc3QuYWRkKFwiZ3JvdXBlZFwiLCBcInJpZ2h0LXNwYWNpbmdcIik7XG4gIG1EZWx0YUdDZWxsLmlkID0gXCJtZXRhbGF0aW9uX2RlbHRhX2dfXCIgKyBtZXRhbC5pZFN1ZmZpeDtcbiAgbURlbHRhR0NlbGwuaW5uZXJUZXh0ID0gbWV0YWwubWV0YWxhdGlvbkRlbHRhRy50b0ZpeGVkKDEpLnRvU3RyaW5nKCk7XG5cbiAgY29uc3QgYm1jQ2VsbDogSFRNTFRhYmxlQ2VsbEVsZW1lbnQgPSByb3cuaW5zZXJ0Q2VsbCgtMSk7XG4gIGJtY0NlbGwuY2xhc3NMaXN0LmFkZChcImJtY1wiLCBcImdyb3VwZWRcIik7XG4gIGNvbnN0IGJtY0lucHV0ID0gY3JlYXRlTWV0YWxOdW1iZXJJbnB1dChcbiAgICBcImJtY1wiLFxuICAgIG1ldGFsLFxuICAgIFwiYnVmZmVyZWRNZXRhbENvbmNlbnRyYXRpb25cIixcbiAgICBmdW5jdGlvbiAoaWQpIHtcbiAgICAgIGNvbnN0IG0gPSBtZXRhbERhdGFTZXQubWV0YWxzW2lkXTtcbiAgICAgICg8SFRNTElucHV0RWxlbWVudD4oXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaWFfZGVsdGFfZ19cIiArIGlkKVxuICAgICAgKSkuaW5uZXJUZXh0ID0gbS5pbnRyYWNlbGx1bGFyQXZhaWxhYmxlRGVsdGFHLnRvRml4ZWQoMSkudG9TdHJpbmcoKTtcbiAgICB9XG4gICk7XG5cbiAgYm1jQ2VsbC5hcHBlbmRDaGlsZChibWNJbnB1dCk7XG5cbiAgY29uc3QgaWFEZWx0YUdDZWxsOiBIVE1MVGFibGVDZWxsRWxlbWVudCA9IHJvdy5pbnNlcnRDZWxsKC0xKTtcbiAgaWFEZWx0YUdDZWxsLmNsYXNzTGlzdC5hZGQoXCJncm91cGVkXCIpO1xuICBpYURlbHRhR0NlbGwuaWQgPSBcImlhX2RlbHRhX2dfXCIgKyBtZXRhbC5pZFN1ZmZpeDtcbiAgaWFEZWx0YUdDZWxsLmlubmVyVGV4dCA9IG1ldGFsLmludHJhY2VsbHVsYXJBdmFpbGFibGVEZWx0YUdcbiAgICAudG9GaXhlZCgxKVxuICAgIC50b1N0cmluZygpO1xuXG4gIGNvbnN0IHJlc3VsdENlbGw6IEhUTUxUYWJsZUNlbGxFbGVtZW50ID0gcm93Lmluc2VydENlbGwoLTEpO1xuICByZXN1bHRDZWxsLmNsYXNzTGlzdC5hZGQoXCJyZXN1bHRcIik7XG4gIHJlc3VsdENlbGwuaWQgPSBcInJlc3VsdF9cIiArIG1ldGFsLmlkU3VmZml4O1xufVxuZnVuY3Rpb24gdG9nZ2xlTWV0YWwod2lsbFR1cm5PZmY6IGJvb2xlYW4sIG1ldGFsOiBtZXRhbHMuTWV0YWwpIHtcbiAgKFxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWZmaW5pdHlfXCIgKyBtZXRhbC5pZFN1ZmZpeCkgYXMgSFRNTElucHV0RWxlbWVudFxuICApLmRpc2FibGVkID0gd2lsbFR1cm5PZmY7XG4gIChcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJtY19cIiArIG1ldGFsLmlkU3VmZml4KSBhcyBIVE1MSW5wdXRFbGVtZW50XG4gICkuZGlzYWJsZWQgPSB3aWxsVHVybk9mZjtcbiAgaWYgKHdpbGxUdXJuT2ZmKSB7XG4gICAgbWV0YWwuc3dpdGNoT2ZmTWV0YWwoKTtcbiAgfSBlbHNlIHtcbiAgICBtZXRhbC5yZXNldFZhbHVlcygpO1xuICB9XG4gIHVwZGF0ZVJvdyhtZXRhbCk7XG4gIGNhbGN1bGF0ZSgpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVSb3cobWV0YWw6IG1ldGFscy5NZXRhbCkge1xuICBjb25zdCBpZCA9IG1ldGFsLmlkU3VmZml4O1xuICAoPEhUTUxJbnB1dEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZmZpbml0eV9cIiArIGlkKSkudmFsdWUgPVxuICAgIG1ldGFsLmFmZmluaXR5LnRvU3RyaW5nKCk7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWV0YWxhdGlvbl9kZWx0YV9nX1wiICsgaWQpLmlubmVyVGV4dCA9XG4gICAgbWV0YWwubWV0YWxhdGlvbkRlbHRhRy50b0ZpeGVkKDEpLnRvU3RyaW5nKCk7XG4gICg8SFRNTElucHV0RWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJtY19cIiArIGlkKSkudmFsdWUgPVxuICAgIG1ldGFsLmJ1ZmZlcmVkTWV0YWxDb25jZW50cmF0aW9uLnRvU3RyaW5nKCk7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaWFfZGVsdGFfZ19cIiArIGlkKS5pbm5lclRleHQgPVxuICAgIG1ldGFsLmludHJhY2VsbHVsYXJBdmFpbGFibGVEZWx0YUcudG9GaXhlZCgxKS50b1N0cmluZygpO1xufVxuXG5mdW5jdGlvbiBjYWxjdWxhdGUoKSB7XG4gIGNvbnN0IHJlc3VsdHMgPSBtZXRhbERhdGFTZXQuY2FsY3VsYXRlT2NjdXBhbmN5KCk7XG5cbiAgZm9yIChjb25zdCBpZCBpbiBtZXRhbERhdGFTZXQubWV0YWxzKSB7XG4gICAgY29uc3QgciA9IHJlc3VsdHNbaWRdO1xuICAgIGNvbnN0IHJlc3VsdENlbGwgPSA8SFRNTFRhYmxlQ2VsbEVsZW1lbnQ+KFxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXN1bHRfXCIgKyBpZClcbiAgICApO1xuICAgIHJlc3VsdENlbGwuaW5uZXJIVE1MID0gKHIgKiAxMDApLnRvRml4ZWQoMikudG9TdHJpbmcoKSArIFwiJVwiO1xuICB9XG5cbiAgY29uc3QgdG90YWxDZWxsID0gPEhUTUxUYWJsZUNlbGxFbGVtZW50PihcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvdGFsLW1ldGFsYXRpb25cIilcbiAgKTtcbiAgdG90YWxDZWxsLmlubmVySFRNTCA9IChyZXN1bHRzW1widG90YWxcIl0gKiAxMDApLnRvRml4ZWQoMikudG9TdHJpbmcoKSArIFwiJVwiO1xuXG4gICg8SFRNTEJ1dHRvbkVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkb3dubG9hZC1idG5cIikpLmRpc2FibGVkID0gZmFsc2U7XG59XG5cbmZ1bmN0aW9uIGNsZWFyQ2FsY3VsYXRpb24oKSB7XG4gIEFycmF5LmZyb20oZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInJlc3VsdFwiKSkuZm9yRWFjaCgoY2VsbCkgPT4ge1xuICAgIGNlbGwuaW5uZXJIVE1MID0gXCJOL0FcIjtcbiAgfSk7XG4gICg8SFRNTEJ1dHRvbkVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkb3dubG9hZC1idG5cIikpLmRpc2FibGVkID0gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gcmVzZXQoKSB7XG4gIGZvciAoY29uc3QgaWQgaW4gbWV0YWxEYXRhU2V0Lm1ldGFscykge1xuICAgIGNvbnN0IG0gPSBtZXRhbERhdGFTZXQubWV0YWxzW2lkXTtcbiAgICBtLnJlc2V0VmFsdWVzKCk7XG4gICAgdXBkYXRlUm93KG0pO1xuICB9XG4gIGNhbGN1bGF0ZSgpO1xufVxuXG4vLyBRdWljayBhbmQgc2ltcGxlIGV4cG9ydCB0YXJnZXQgI3RhYmxlSWQgaW50byBhIGNzdlxuZnVuY3Rpb24gZG93bmxvYWRUYWJsZUFzQ3N2KHRhYmxlSWQ6IHN0cmluZywgc2VwYXJhdG9yID0gXCIsXCIpIHtcbiAgLy8gU2VsZWN0IHJvd3MgZnJvbSB0YWJsZUlkXG4gIGNvbnN0IHJvd3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwidGFibGUjXCIgKyB0YWJsZUlkICsgXCIgdHJcIik7XG4gIC8vIENvbnN0cnVjdCBjc3ZcbiAgY29uc3QgY3N2ID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgcm93cy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHJvdyA9IFtdO1xuICAgIGNvbnN0IGNvbHMgPSA8Tm9kZUxpc3RPZjxIVE1MVGFibGVDZWxsRWxlbWVudD4+KFxuICAgICAgcm93c1tpXS5xdWVyeVNlbGVjdG9yQWxsKFwidGQsIHRoXCIpXG4gICAgKTtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGNvbHMubGVuZ3RoOyBqKyspIHtcbiAgICAgIC8vIENsZWFuIGlubmVydGV4dCB0byByZW1vdmUgbXVsdGlwbGUgc3BhY2VzIGFuZCBqdW1wbGluZSAoYnJlYWsgY3N2KVxuICAgICAgbGV0IGRhdGE7XG4gICAgICBjb25zdCBpbnB1dHMgPSBjb2xzW2pdLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIik7XG4gICAgICBpZiAoaW5wdXRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZGF0YSA9IGlucHV0c1swXS52YWx1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRhdGEgPSBjb2xzW2pdLmlubmVyVGV4dDtcbiAgICAgIH1cbiAgICAgIC8vIFJlbW92ZSBsaW5lIGJyZWFrcyBhbmQgZXNjYXBlIGRvdWJsZS1xdW90ZSB3aXRoIGRvdWJsZS1kb3VibGUtcXVvdGVcbiAgICAgIGRhdGEgPSBkYXRhLnJlcGxhY2UoLyhcXHJcXG58XFxufFxccikvZ20sIFwiXCIpLnJlcGxhY2UoLyhcXHNcXHMpL2dtLCBcIiBcIik7XG4gICAgICBkYXRhID0gZGF0YS5yZXBsYWNlKC9cIi9nLCAnXCJcIicpO1xuICAgICAgZGF0YSA9IGRhdGEucmVwbGFjZSgvXFx1MjIwNi9nLCBcIkRlbHRhIFwiKTtcbiAgICAgIC8vIFB1c2ggZXNjYXBlZCBzdHJpbmdcbiAgICAgIHJvdy5wdXNoKCdcIicgKyBkYXRhICsgJ1wiJyk7XG4gICAgfVxuICAgIGNzdi5wdXNoKHJvdy5qb2luKHNlcGFyYXRvcikpO1xuICB9XG4gIGNvbnN0IGNzdlN0cmluZyA9IGNzdi5qb2luKFwiXFxuXCIpO1xuICAvLyBEb3dubG9hZCBpdFxuICBjb25zdCBmaWxlbmFtZSA9XG4gICAgXCJleHBvcnRfXCIgKyB0YWJsZUlkICsgXCJfXCIgKyBuZXcgRGF0ZSgpLnRvTG9jYWxlRGF0ZVN0cmluZygpICsgXCIuY3N2XCI7XG4gIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKTtcbiAgbGluay5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gIGxpbmsuc2V0QXR0cmlidXRlKFwidGFyZ2V0XCIsIFwiX2JsYW5rXCIpO1xuICBsaW5rLnNldEF0dHJpYnV0ZShcbiAgICBcImhyZWZcIixcbiAgICBcImRhdGE6dGV4dC9jc3Y7Y2hhcnNldD11dGYtOCxcIiArIGVuY29kZVVSSUNvbXBvbmVudChjc3ZTdHJpbmcpXG4gICk7XG4gIGxpbmsuc2V0QXR0cmlidXRlKFwiZG93bmxvYWRcIiwgZmlsZW5hbWUpO1xuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspO1xuICBsaW5rLmNsaWNrKCk7XG4gIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobGluayk7XG59XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XG4gIGNvbnN0IG1ldGFsVGFibGUgPSA8SFRNTFRhYmxlRWxlbWVudD4oXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtZXRhbGF0aW9uLXRhYmxlXCIpXG4gICk7XG4gIGZvciAoY29uc3QgaWQgaW4gbWV0YWxEYXRhU2V0Lm1ldGFscykge1xuICAgIGNvbnN0IG0gPSBtZXRhbERhdGFTZXQubWV0YWxzW2lkXTtcbiAgICBhcHBlbmRNZXRhbFRhYmxlUm93KG0sIG1ldGFsVGFibGUpO1xuICB9XG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkb3dubG9hZC1idG5cIikub25jbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICBkb3dubG9hZFRhYmxlQXNDc3YoXCJtZXRhbGF0aW9uLXRhYmxlXCIpO1xuICB9O1xuXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzZXQtYnRuXCIpLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmVzZXQoKTtcbiAgfTtcblxuICBjYWxjdWxhdGUoKTtcbn0pO1xuIiwiLyoqXG4gKiBBbiBvYmplY3QgdG8gc3RvcmUgdmFsdWVzIGZvciBhIHNpbmdsZSBtZXRhbCBhbmQgY2FsY3VsYXRlIGRlbHRhIEcgdmFsdWVzXG4gKi9cbmV4cG9ydCBjbGFzcyBNZXRhbCB7XG4gIG5hbWU6IHN0cmluZztcbiAgc3ltYm9sOiBzdHJpbmc7XG4gIF9hZmZpbml0eTogbnVtYmVyO1xuICBfZGVmYXVsdEFmZmluaXR5OiBudW1iZXI7XG4gIF9tZXRhbGF0aW9uRGVsdGFHOiBudW1iZXI7XG4gIF9idWZmZXJlZE1ldGFsQ29uY2VudHJhdGlvbjogbnVtYmVyO1xuICBfZGVmYXVsdE1ldGFsQ29uY2VudHJhdGlvbjogbnVtYmVyO1xuICBfaW50cmFjZWxsdWxhckF2YWlsYWJsZURlbHRhRzogbnVtYmVyO1xuICBpZFN1ZmZpeDogc3RyaW5nO1xuICB2YWxpZGF0b3I6IHR5cGVvZiBQcm94eTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBuYW1lOiBzdHJpbmcsXG4gICAgc3ltYm9sOiBzdHJpbmcsXG4gICAgYWZmaW5pdHk6IG51bWJlcixcbiAgICBjb25jZW50cmF0aW9uOiBudW1iZXJcbiAgKSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLnN5bWJvbCA9IHN5bWJvbDtcbiAgICB0aGlzLmFmZmluaXR5ID0gYWZmaW5pdHk7XG4gICAgdGhpcy5idWZmZXJlZE1ldGFsQ29uY2VudHJhdGlvbiA9IGNvbmNlbnRyYXRpb247XG4gICAgdGhpcy5pZFN1ZmZpeCA9IHN5bWJvbC50b0xvd2VyQ2FzZSgpO1xuICAgIHRoaXMuX2RlZmF1bHRBZmZpbml0eSA9IGFmZmluaXR5O1xuICAgIHRoaXMuX2RlZmF1bHRNZXRhbENvbmNlbnRyYXRpb24gPSBjb25jZW50cmF0aW9uO1xuICB9XG5cbiAgY2FsY3VsYXRlRGVsdGFHKG1vbGVWYWx1ZTogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gKDguMzE0ICogMjk4LjE1ICogTWF0aC5sb2cobW9sZVZhbHVlKSkgLyAxMDAwO1xuICB9XG5cbiAgY2hlY2tSYW5nZSh2YWw6IG51bWJlciwgZmllbGROYW1lOiBzdHJpbmcpIHtcbiAgICBpZiAoaXNOYU4odmFsKSkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoZmllbGROYW1lICsgXCIgbXVzdCBiZSBzZXRcIik7XG4gICAgaWYgKHZhbCA8IDFlLTMwIHx8IHZhbCA+IDEwMDApIHtcbiAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKGZpZWxkTmFtZSArIFwiIG11c3QgYmUgYmV0d2VlbiAxZS0zMCBhbmQgMTAwMFwiKTtcbiAgICB9XG4gIH1cblxuICBnZXQgYWZmaW5pdHkoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fYWZmaW5pdHk7XG4gIH1cblxuICBzZXQgYWZmaW5pdHkodmFsOiBudW1iZXIpIHtcbiAgICB0aGlzLmNoZWNrUmFuZ2UodmFsLCBcIkFmZmluaXR5XCIpO1xuICAgIHRoaXMuX2FmZmluaXR5ID0gdmFsO1xuICAgIHRoaXMuX21ldGFsYXRpb25EZWx0YUcgPSB0aGlzLmNhbGN1bGF0ZURlbHRhRyh0aGlzLl9hZmZpbml0eSk7XG4gIH1cblxuICBnZXQgbWV0YWxhdGlvbkRlbHRhRygpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9tZXRhbGF0aW9uRGVsdGFHO1xuICB9XG5cbiAgZ2V0IGJ1ZmZlcmVkTWV0YWxDb25jZW50cmF0aW9uKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuX2J1ZmZlcmVkTWV0YWxDb25jZW50cmF0aW9uO1xuICB9XG5cbiAgc2V0IGJ1ZmZlcmVkTWV0YWxDb25jZW50cmF0aW9uKHZhbDogbnVtYmVyKSB7XG4gICAgdGhpcy5jaGVja1JhbmdlKHZhbCwgXCJCdWZmZXJlZCBtZXRhbCBjb25jZW50cmF0aW9uXCIpO1xuICAgIHRoaXMuX2J1ZmZlcmVkTWV0YWxDb25jZW50cmF0aW9uID0gdmFsO1xuICAgIHRoaXMuX2ludHJhY2VsbHVsYXJBdmFpbGFibGVEZWx0YUcgPSB0aGlzLmNhbGN1bGF0ZURlbHRhRyhcbiAgICAgIHRoaXMuX2J1ZmZlcmVkTWV0YWxDb25jZW50cmF0aW9uXG4gICAgKTtcbiAgfVxuXG4gIGdldCBpbnRyYWNlbGx1bGFyQXZhaWxhYmxlRGVsdGFHKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuX2ludHJhY2VsbHVsYXJBdmFpbGFibGVEZWx0YUc7XG4gIH1cblxuICBzZXQgaW50cmFjZWxsdWxhckF2YWlsYWJsZURlbHRhRyh2YWw6IG51bWJlcikge1xuICAgIGlmICh2YWwgPD0gMClcbiAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwiSW50cmFjZWxsdWxhciBhdmFpbGFibGUg4oiGRyBtdXN0IGJlID4gMFwiKTtcbiAgICB0aGlzLl9pbnRyYWNlbGx1bGFyQXZhaWxhYmxlRGVsdGFHID0gdmFsO1xuICB9XG5cbiAgZ2V0UHJvcGVydHkoa2V5OiBrZXlvZiBNZXRhbCkge1xuICAgIHJldHVybiB0aGlzW2tleV07XG4gIH1cblxuICBzd2l0Y2hPZmZNZXRhbCgpIHtcbiAgICB0aGlzLmFmZmluaXR5ID0gMTAwMDtcbiAgICB0aGlzLmJ1ZmZlcmVkTWV0YWxDb25jZW50cmF0aW9uID0gdGhpcy5fZGVmYXVsdE1ldGFsQ29uY2VudHJhdGlvbjtcbiAgfVxuXG4gIHJlc2V0VmFsdWVzKCkge1xuICAgIHRoaXMuYWZmaW5pdHkgPSB0aGlzLl9kZWZhdWx0QWZmaW5pdHk7XG4gICAgdGhpcy5idWZmZXJlZE1ldGFsQ29uY2VudHJhdGlvbiA9IHRoaXMuX2RlZmF1bHRNZXRhbENvbmNlbnRyYXRpb247XG4gIH1cbn1cblxuY29uc3QgTUVUQUxfVkFMUzogQXJyYXk8W3N0cmluZywgc3RyaW5nLCBudW1iZXIsIG51bWJlcl0+ID0gW1xuICBbXCJNYWduZXNpdW1cIiwgXCJNZ1wiLCAxZTMsIDIuN2UtM10sXG4gIFtcIk1hbmdhbmVzZVwiLCBcIk1uXCIsIDFlMywgMi42ZS02XSxcbiAgW1wiSXJvblwiLCBcIkZlXCIsIDFlLTYsIDQuOGUtOF0sXG4gIFtcIkNvYmFsdFwiLCBcIkNvXCIsIDNlLTExLCAyLjVlLTldLFxuICBbXCJOaWNrZWxcIiwgXCJOaVwiLCA5LjhlLTEwLCAxLjhlLTEzXSxcbiAgW1wiQ29wcGVyXCIsIFwiQ3VcIiwgMi40ZS0xNiwgMS4yZS0xOF0sXG4gIFtcIlppbmNcIiwgXCJablwiLCAxLjllLTEzLCAxLjE5ZS0xMl0sXG5dO1xuXG5leHBvcnQgY2xhc3MgTWV0YWxEYXRhU2V0IHtcbiAgbWV0YWxzOiB7IFtpZDogc3RyaW5nXTogTWV0YWwgfTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLm1ldGFscyA9IHt9O1xuICAgIGZvciAoY29uc3QgbSBvZiBNRVRBTF9WQUxTKSB7XG4gICAgICB0aGlzLm1ldGFsc1ttWzFdLnRvTG93ZXJDYXNlKCldID0gbmV3IE1ldGFsKC4uLm0pO1xuICAgIH1cbiAgfVxuXG4gIGNhbGN1bGF0ZU9jY3VwYW5jeSgpOiB7IFtpZDogc3RyaW5nXTogbnVtYmVyIH0ge1xuICAgIGNvbnN0IGV4cFNjYWxlZERpZmZlcmVuY2VzOiB7IFtpZDogc3RyaW5nXTogbnVtYmVyIH0gPSB7fTtcbiAgICBsZXQgdG90YWxEaWZmcyA9IDA7XG4gICAgZm9yIChjb25zdCBpZCBpbiB0aGlzLm1ldGFscykge1xuICAgICAgY29uc3QgbSA9IHRoaXMubWV0YWxzW2lkXTtcbiAgICAgIGV4cFNjYWxlZERpZmZlcmVuY2VzW2lkXSA9IE1hdGguZXhwKFxuICAgICAgICAoMTAwMCAqIChtLmludHJhY2VsbHVsYXJBdmFpbGFibGVEZWx0YUcgLSBtLm1ldGFsYXRpb25EZWx0YUcpKSAvXG4gICAgICAgICAgKDguMzE0ICogMjk4LjE1KVxuICAgICAgKTtcbiAgICAgIHRvdGFsRGlmZnMgKz0gZXhwU2NhbGVkRGlmZmVyZW5jZXNbaWRdO1xuICAgIH1cblxuICAgIGNvbnN0IG9jY3VwYW5jaWVzOiB7IFtpZDogc3RyaW5nXTogbnVtYmVyIH0gPSB7fTtcbiAgICBsZXQgdG90YWxPY2N1cGFuY3kgPSAwO1xuXG4gICAgZm9yIChjb25zdCBpZCBpbiB0aGlzLm1ldGFscykge1xuICAgICAgb2NjdXBhbmNpZXNbaWRdID0gZXhwU2NhbGVkRGlmZmVyZW5jZXNbaWRdIC8gKDEgKyB0b3RhbERpZmZzKTtcbiAgICAgIHRvdGFsT2NjdXBhbmN5ICs9IG9jY3VwYW5jaWVzW2lkXTtcbiAgICB9XG4gICAgb2NjdXBhbmNpZXNbXCJ0b3RhbFwiXSA9IHRvdGFsT2NjdXBhbmN5O1xuXG4gICAgcmV0dXJuIG9jY3VwYW5jaWVzO1xuICB9XG59XG4iXX0=
